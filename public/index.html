<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>AS140915 信息页</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: sans-serif; padding: 2rem; max-width: 600px; margin: auto; }
    .card { border: 1px solid #ddd; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; }
    .loading { color: #888; }
  </style>
</head>
<body>
  <h1>AS 查询：<span id="asn-title">140915</span></h1>
  <div id="content" class="loading">正在加载……</div>
  <button id="refresh">刷新</button>

  <script>
    async function fetchASN(asn = '140915') {
      const el = document.getElementById('content');
      el.textContent = '正在加载……';
      try {
        const res = await fetch(`/api/asn?id=${asn}`);
        const json = await res.json();

        // 构建展示
        const c = document.createElement('div');
        c.innerHTML = `
          <div class="card">
            <strong>ASN:</strong> ${json.data.asn}<br>
            <strong>名称:</strong> ${json.data.name}<br>
            <strong>描述:</strong> ${json.data.description || '—'}<br>
            <strong>国家:</strong> ${json.data.country_code}<br>
            <strong>首见:</strong> ${new Date(json.data.first_seen * 1000).toLocaleDateString()}<br>
            <strong>最新:</strong> ${new Date(json.data.last_updated * 1000).toLocaleDateString()}<br>
            <strong>IP 前缀数:</strong> ${json.data.prefixes.length}<br>
          </div>
        `;
        el.innerHTML = '';
        el.appendChild(c);
      } catch (e) {
        el.textContent = '加载失败：' + e;
      }
    }

    document.getElementById('refresh').onclick = () => {
      fetchASN();
    };

    // 初次加载
    fetchASN();
    // 每 5 分钟自动刷新一次
    setInterval(fetchASN, 5 * 60 * 1000);
  </script>
</body>
</html>